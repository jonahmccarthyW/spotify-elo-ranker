<!DOCTYPE html>
<html>
<head>
    <title>Spotify Elo Ranker</title>
    <style>
        body { font-family: sans-serif; background: #121212; color: white; padding: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 10px; text-align: left; border-bottom: 1px solid #333; }
        .btn { background: #287a43; color: #ffffff; padding: 10px 20px; text-decoration: none; border-radius: 20px; display: inline-block; margin-top: 5px; }
        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; padding-bottom: 20px; }
        .sub-nav { display: flex; gap: 10px; }
        .playlist-badge { background: #333; padding: 5px 15px; border-radius: 10px; color: #1DB954; font-weight: bold; font-size: 0.9rem; }
    </style>
</head>
<body>
    <div class="header">
        <div>
            <div style="display: flex; align-items: center; gap: 15px;">
                <h1>üèÜ Leaderboard</h1>
                <span class="playlist-badge">{{ playlist_name }}</span>
            </div>
            {% if not first_run %}
                <span style="color: #888; font-size: 1.1rem;">
                    {{ total_matches }} matches played
                </span>
            {% endif %}
        </div>

        <div class="sub-nav">
            <a href="/" class="btn" style="background: #333; border: 1px solid #555;">Switch Playlist</a>

            {% if logged_in %}
                {% if not first_run %}
                    <a href="/push" class="btn" style="background: #25529c;">‚òÅÔ∏è Push to Spotify</a>
                    <a href="/rank" class="btn" style="background: #146c43;">‚öîÔ∏è Rank</a>
                    <a href="/reset" class="btn" style="background: #671111;" onclick="return confirm('Wipe all ratings for this playlist?');">üí£ Reset</a>
                {% endif %}
                <a href="/ingest" class="btn" style="background:#555;">Fetch Songs</a>
            {% else %}
                <a href="/login" class="btn" style="background: #146c43;">Login</a>
            {% endif %}
        </div>
    </div>

    {% if first_run %}
        <div style="text-align: center; margin-top: 50px;">
            <h2>Fresh Playlist!</h2>
            <p>Click <b>Fetch Songs</b> to import tracks from Spotify.</p>
        </div>
    {% else %}
        <table>
            <tr>
                <th>Rank</th>
                <th>Rating</th>
                <th>Song</th>
                <th>Artist</th>
                <th>Matches</th>
            </tr>
            {% for song in songs %}
            <tr>
                <td>{{ loop.index }}</td>
                <td style="color: #1DB954; font-weight:bold;">{{ song.rating }}</td>
                <td>{{ song.name }}</td>
                <td>{{ song.artist }}</td>
                <td>{{ song.matches }}</td>
            </tr>
            {% endfor %}
        </table>
    {% endif %}
</body>
</html>